I used AWS EMR so some of it might need to be modified (Didn't use a reducer)
 hadoop-streaming -files s3://data-q1/mapper.py,s3://data-q1/reducer.py -mapper "python mapper.py" -input s3://data-q1/source/ -output s3://data-q1/tout
 hadoop-streaming -files s3://data-q1/mapper2.py,s3://data-q1/reducer.py -mapper "python mapper2.py" -input s3://data-q1/tout/ -output s3://data-q1/tout2